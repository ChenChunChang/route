(function(){var t="route",e={"riot-observable":"observable"};var n=typeof define==="function"&&define.amd?define:function(t){var n=typeof exports==="object"&&!exports.nodeType,i=n?require:function(t){return window[e[t]||t]},r=n?module:{_g:true};t(i,0,r)};n(function(e,n,i){var r=e("riot-observable");var o=/^.+?\/+[^\/]+/,f="EventListener",s="remove"+f,u="add"+f,a="hasAttribute",c="replace",h="popstate",l="trigger",p=window,d=document,v=p.history.location||p.location,m=_.prototype,b=d&&d.ontouchstart?"touchstart":"click",w=false,g=r(),y,x,$,A;function K(t){return t.split(/[\/?#]/)}function N(t,e){var n=new RegExp("^"+e[c](/\*/g,"(\\w+)")[c](/\.\./,".*")+"$");if(args=t.match(n))return args.slice(1)}function _(){this.$=[];r(this);g.on("stop",this.s.bind(this));g.on("emit",this.e.bind(this))}function q(t){return t[c](/^\/|\/$/,"")}function E(t){return(t||v.href)[c](o,"")}function j(t){return y[0]=="#"?(t||v.href).split(y)[1]||"":E(t)[c](y,"")}function k(t){var e=j();if(t||e!=x){g[l]("emit",e);x=e}}function D(t){if(t.which!=1||t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)return;var e=t.target;while(e&&e.nodeName!="A")e=e.parentNode;if(!e||e.nodeName!="A"||e[a]("download")||!e[a]("href")||e.target&&e.target!="_self"||e.href.indexOf(v.href.match(o)[0])==-1)return;if(e.href!=v.href){if(e.href.split("#")[0]==v.href.split("#")[0])return;L(j(e.href),e.title||d.title)}t.preventDefault()}function L(t,e){e=e||d.title;history.pushState(null,e,y+t);d.title=e;k()}m.m=function(t,e){if(t[0]&&(!e||e[0]))L(t,e);else if(e)this.r(t,e);else this.r("@",t)};m.s=function(){this.off("*");this.$=[]};m.e=function(t){this.$.concat("@").some(function(e){var n=(e=="@"?$:A)(q(t),q(e));if(n){this[l].apply(null,[e].concat(n));return true}},this)};m.r=function(t,e){if(t!="@")this.$.push(t);this.on(t,e)};var O=new _;var P=O.m.bind(O);P.create=function(){var t=new _;t.m.stop=t.s.bind(t);return t.m.bind(t)};P.base=function(t){y=t||"#";x=j()};P.exec=function(){k(true)};P.parser=function(t,e){if(!t&&!e){$=K;A=N}if(t)$=t;if(e)A=e};P.query=function(){var t={};v.href[c](/[?&](.+?)=([^&]*)/g,function(e,n,i){t[n]=i});return t};P.stop=function(){if(w){p[s](h,k);d[s](b,D);g[l]("stop");w=false}};P.start=function(){if(!w){p[u](h,k);d[u](b,D);w=true}};P.base();P.parser();P.start();i.exports=P;if(i._g)window[t]=i.exports})})();