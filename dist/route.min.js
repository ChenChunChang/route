(function(){var t=function(t){t=t||{};var n={},e=function(t,n){t.replace(/\S+/g,n)};t.on=function(r,i){if(typeof i!="function")return t;e(r,function(t,e){(n[t]=n[t]||[]).push(i);i.typed=e>0});return t};t.off=function(r,i){if(r=="*")n={};else{e(r,function(t){if(i){var e=n[t];for(var r=0,f;f=e&&e[r];++r){if(f==i)e.splice(r--,1)}}else delete n[t]})}return t};t.one=function(n,e){function r(){t.off(n,r);e.apply(t,arguments)}return t.on(n,r)};t.trigger=function(r){var i=[].slice.call(arguments,1);e(r,function(e){var r=n[e]||[];for(var f=0,o;o=r[f];++f){if(o.busy)return;o.busy=1;o.apply(t,o.typed?[e].concat(i):i);if(r[f]!==o)f--;o.busy=0}if(n.all&&e!="all")t.trigger.apply(t,["all",e].concat(i))});return t};return t};var n=/^.+?\/+[^\/]+/,e="EventListener",r="remove"+e,i="add"+e,f="hasAttribute",o="replace",u="popstate",a="trigger",c=window,s=document,l=c.history.location||c.location,h=x.prototype,p=s&&s.ontouchstart?"touchstart":"click",d=false,v=t(),g,y,m,b;function w(t){return t.split(/[/?#]/)}function $(t,n){var e=new RegExp("^"+n[o](/\*/g,"(\\w+)")[o](/\.\./,".*")+"$");if(args=t.match(e))return args.slice(1)}function x(){this.$=[];t(this);v.on("stop",this.s.bind(this));v.on("emit",this.e.bind(this))}function A(t){return t[o](/^\/|\/$/,"")}function K(t){return(t||l.href)[o](n,"")}function N(t){return g[0]=="#"?(t||l.href).split(g)[1]||"":K(t)[o](g,"")}function E(t){var n=N();if(t||n!=y){v[a]("emit",n);y=n}}function S(t){if(t.which!=1||t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)return;var e=t.target;while(e&&e.nodeName!="A")e=e.parentNode;if(!e||e.nodeName!="A"||e[f]("download")||!e[f]("href")||e.target&&e.target!="_self"||e.href.indexOf(l.href.match(n)[0])==-1)return;if(e.href!=l.href){if(e.href.split("#")[0]==l.href.split("#")[0])return;k(N(e.href),e.title||s.title)}t.preventDefault()}function k(t,n){n=n||s.title;history.pushState(null,n,g+t);s.title=n;E()}h.m=function(t,n){if(t[0]&&(!n||n[0]))k(t,n);else if(n)this.r(t,n);else this.r("@",t)};h.s=function(){this.off("*");this.$=[]};h.e=function(t){this.$.concat("@").some(function(n){var e=(n=="@"?m:b)(A(t),A(n));if(e){this[a].apply(null,[n].concat(e));return true}},this)};h.r=function(t,n){if(t!="@")this.$.push(t);this.on(t,n)};var q=new x;var D=q.m.bind(q);D.create=function(){var t=new x;t.m.stop=t.s.bind(t);return t.m.bind(t)};D.base=function(t){g=t||"#";y=N()};D.exec=function(){E(true)};D.parser=function(t,n){if(!t&&!n){m=w;b=$}if(t)m=t;if(n)b=n};D.query=function(){var t={};l.href[o](/[?&](.+?)=([^&]*)/g,function(n,e,r){t[e]=r});return t};D.stop=function(){if(d){c[r](u,E);s[r](p,S);v[a]("stop");d=false}};D.start=function(){if(!d){c[i](u,E);s[i](p,S);d=true}};D.base();D.parser();D.start();window.route=D})();